/*!
 * nedboose
 * Mongoose-style ODM for NeDB
 * Copyright (c) 2016 James M. Greene
 * Licensed MIT
 * https://github.com/JamesMGreene/nedboose#readme
 * v0.1.0
 */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.nedboose=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d={nedb:a("nedb"),version:a("./package.json").version,Nedboose:a("./src/nedboose"),Connection:a("./src/connection"),createConnection:function(){},connect:function(){},disconnect:function(){},connection:null,Collection:a("./src/collection"),Document:a("./src/document"),Model:a("./src/model"),Schema:a("./src/schema"),SchemaType:a("./src/schema-type"),SchemaTypes:a("./src/schema-types"),Types:a("./src/types"),VirtualType:a("./src/virtual-type"),model:function(){},modelNames:function(){},Query:a("./src/query"),Aggregate:a("./src/aggregate"),Error:a("./src/error")};b.exports=d},{"./package.json":24,"./src/aggregate":25,"./src/collection":26,"./src/connection":27,"./src/document":28,"./src/error":29,"./src/model":30,"./src/nedboose":31,"./src/query":32,"./src/schema":35,"./src/schema-type":33,"./src/schema-types":34,"./src/types":36,"./src/virtual-type":37,nedb:11}],2:[function(a,b,c){b.exports.BinarySearchTree=a("./lib/bst"),b.exports.AVLTree=a("./lib/avltree")},{"./lib/avltree":3,"./lib/bst":4}],3:[function(a,b,c){function d(a){this.tree=new e(a)}function e(a){a=a||{},this.left=null,this.right=null,this.parent=void 0!==a.parent?a.parent:null,a.hasOwnProperty("key")&&(this.key=a.key),this.data=a.hasOwnProperty("value")?[a.value]:[],this.unique=a.unique||!1,this.compareKeys=a.compareKeys||g.defaultCompareKeysFunction,this.checkValueEquality=a.checkValueEquality||g.defaultCheckValueEquality}var f=a("./bst"),g=a("./customUtils"),h=a("util");a("underscore");h.inherits(e,f),d._AVLTree=e,e.prototype.checkHeightCorrect=function(){var a,b;if(this.hasOwnProperty("key")){if(this.left&&void 0===this.left.height)throw new Error("Undefined height for node "+this.left.key);if(this.right&&void 0===this.right.height)throw new Error("Undefined height for node "+this.right.key);if(void 0===this.height)throw new Error("Undefined height for node "+this.key);if(a=this.left?this.left.height:0,b=this.right?this.right.height:0,this.height!==1+Math.max(a,b))throw new Error("Height constraint failed for node "+this.key);this.left&&this.left.checkHeightCorrect(),this.right&&this.right.checkHeightCorrect()}},e.prototype.balanceFactor=function(){var a=this.left?this.left.height:0,b=this.right?this.right.height:0;return a-b},e.prototype.checkBalanceFactors=function(){if(Math.abs(this.balanceFactor())>1)throw new Error("Tree is unbalanced at node "+this.key);this.left&&this.left.checkBalanceFactors(),this.right&&this.right.checkBalanceFactors()},e.prototype.checkIsAVLT=function(){e.super_.prototype.checkIsBST.call(this),this.checkHeightCorrect(),this.checkBalanceFactors()},d.prototype.checkIsAVLT=function(){this.tree.checkIsAVLT()},e.prototype.rightRotation=function(){var a,b,c,d,e=this,f=this.left;return f?(a=f.right,e.parent?(f.parent=e.parent,e.parent.left===e?e.parent.left=f:e.parent.right=f):f.parent=null,f.right=e,e.parent=f,e.left=a,a&&(a.parent=e),b=f.left?f.left.height:0,c=a?a.height:0,d=e.right?e.right.height:0,e.height=Math.max(c,d)+1,f.height=Math.max(b,e.height)+1,f):this},e.prototype.leftRotation=function(){var a,b,c,d,e=this,f=this.right;return f?(a=f.left,e.parent?(f.parent=e.parent,e.parent.left===e?e.parent.left=f:e.parent.right=f):f.parent=null,f.left=e,e.parent=f,e.right=a,a&&(a.parent=e),b=e.left?e.left.height:0,c=a?a.height:0,d=f.right?f.right.height:0,e.height=Math.max(b,c)+1,f.height=Math.max(d,e.height)+1,f):this},e.prototype.rightTooSmall=function(){return this.balanceFactor()<=1?this:(this.left.balanceFactor()<0&&this.left.leftRotation(),this.rightRotation())},e.prototype.leftTooSmall=function(){return this.balanceFactor()>=-1?this:(this.right.balanceFactor()>0&&this.right.rightRotation(),this.leftRotation())},e.prototype.rebalanceAlongPath=function(a){var b,c,d=this;if(!this.hasOwnProperty("key"))return delete this.height,this;for(c=a.length-1;c>=0;c-=1)a[c].height=1+Math.max(a[c].left?a[c].left.height:0,a[c].right?a[c].right.height:0),a[c].balanceFactor()>1&&(b=a[c].rightTooSmall(),0===c&&(d=b)),a[c].balanceFactor()<-1&&(b=a[c].leftTooSmall(),0===c&&(d=b));return d},e.prototype.insert=function(a,b){var c=[],d=this;if(!this.hasOwnProperty("key"))return this.key=a,this.data.push(b),this.height=1,this;for(;;){if(0===d.compareKeys(d.key,a)){if(d.unique){var e=new Error("Can't insert key "+a+", it violates the unique constraint");throw e.key=a,e.errorType="uniqueViolated",e}return d.data.push(b),this}if(c.push(d),d.compareKeys(a,d.key)<0){if(!d.left){c.push(d.createLeftChild({key:a,value:b}));break}d=d.left}else{if(!d.right){c.push(d.createRightChild({key:a,value:b}));break}d=d.right}}return this.rebalanceAlongPath(c)},d.prototype.insert=function(a,b){var c=this.tree.insert(a,b);c&&(this.tree=c)},e.prototype["delete"]=function(a,b){var c,d=[],e=this,f=[];if(!this.hasOwnProperty("key"))return this;for(;;){if(0===e.compareKeys(a,e.key))break;if(f.push(e),e.compareKeys(a,e.key)<0){if(!e.left)return this;e=e.left}else{if(!e.right)return this;e=e.right}}if(e.data.length>1&&b)return e.data.forEach(function(a){e.checkValueEquality(a,b)||d.push(a)}),e.data=d,this;if(!e.left&&!e.right)return e===this?(delete e.key,e.data=[],delete e.height,this):(e.parent.left===e?e.parent.left=null:e.parent.right=null,this.rebalanceAlongPath(f));if(!e.left||!e.right)return c=e.left?e.left:e.right,e===this?(c.parent=null,c):(e.parent.left===e?(e.parent.left=c,c.parent=e.parent):(e.parent.right=c,c.parent=e.parent),this.rebalanceAlongPath(f));if(f.push(e),c=e.left,!c.right)return e.key=c.key,e.data=c.data,e.left=c.left,c.left&&(c.left.parent=e),this.rebalanceAlongPath(f);for(;;){if(!c.right)break;f.push(c),c=c.right}return e.key=c.key,e.data=c.data,c.parent.right=c.left,c.left&&(c.left.parent=c.parent),this.rebalanceAlongPath(f)},d.prototype["delete"]=function(a,b){var c=this.tree["delete"](a,b);c&&(this.tree=c)},["getNumberOfKeys","search","betweenBounds","prettyPrint","executeOnEveryNode"].forEach(function(a){d.prototype[a]=function(){return this.tree[a].apply(this.tree,arguments)}}),b.exports=d},{"./bst":4,"./customUtils":5,underscore:6,util:23}],4:[function(a,b,c){function d(a){a=a||{},this.left=null,this.right=null,this.parent=void 0!==a.parent?a.parent:null,a.hasOwnProperty("key")&&(this.key=a.key),this.data=a.hasOwnProperty("value")?[a.value]:[],this.unique=a.unique||!1,this.compareKeys=a.compareKeys||f.defaultCompareKeysFunction,this.checkValueEquality=a.checkValueEquality||f.defaultCheckValueEquality}function e(a,b){var c;for(c=0;c<b.length;c+=1)a.push(b[c])}var f=a("./customUtils");d.prototype.getMaxKeyDescendant=function(){return this.right?this.right.getMaxKeyDescendant():this},d.prototype.getMaxKey=function(){return this.getMaxKeyDescendant().key},d.prototype.getMinKeyDescendant=function(){return this.left?this.left.getMinKeyDescendant():this},d.prototype.getMinKey=function(){return this.getMinKeyDescendant().key},d.prototype.checkAllNodesFullfillCondition=function(a){this.hasOwnProperty("key")&&(a(this.key,this.data),this.left&&this.left.checkAllNodesFullfillCondition(a),this.right&&this.right.checkAllNodesFullfillCondition(a))},d.prototype.checkNodeOrdering=function(){var a=this;this.hasOwnProperty("key")&&(this.left&&(this.left.checkAllNodesFullfillCondition(function(b){if(a.compareKeys(b,a.key)>=0)throw new Error("Tree with root "+a.key+" is not a binary search tree")}),this.left.checkNodeOrdering()),this.right&&(this.right.checkAllNodesFullfillCondition(function(b){if(a.compareKeys(b,a.key)<=0)throw new Error("Tree with root "+a.key+" is not a binary search tree")}),this.right.checkNodeOrdering()))},d.prototype.checkInternalPointers=function(){if(this.left){if(this.left.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.left.checkInternalPointers()}if(this.right){if(this.right.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.right.checkInternalPointers()}},d.prototype.checkIsBST=function(){if(this.checkNodeOrdering(),this.checkInternalPointers(),this.parent)throw new Error("The root shouldn't have a parent")},d.prototype.getNumberOfKeys=function(){var a;return this.hasOwnProperty("key")?(a=1,this.left&&(a+=this.left.getNumberOfKeys()),this.right&&(a+=this.right.getNumberOfKeys()),a):0},d.prototype.createSimilar=function(a){return a=a||{},a.unique=this.unique,a.compareKeys=this.compareKeys,a.checkValueEquality=this.checkValueEquality,new this.constructor(a)},d.prototype.createLeftChild=function(a){var b=this.createSimilar(a);return b.parent=this,this.left=b,b},d.prototype.createRightChild=function(a){var b=this.createSimilar(a);return b.parent=this,this.right=b,b},d.prototype.insert=function(a,b){if(!this.hasOwnProperty("key"))return this.key=a,void this.data.push(b);if(0===this.compareKeys(this.key,a)){if(this.unique){var c=new Error("Can't insert key "+a+", it violates the unique constraint");throw c.key=a,c.errorType="uniqueViolated",c}return void this.data.push(b)}this.compareKeys(a,this.key)<0?this.left?this.left.insert(a,b):this.createLeftChild({key:a,value:b}):this.right?this.right.insert(a,b):this.createRightChild({key:a,value:b})},d.prototype.search=function(a){return this.hasOwnProperty("key")?0===this.compareKeys(this.key,a)?this.data:this.compareKeys(a,this.key)<0?this.left?this.left.search(a):[]:this.right?this.right.search(a):[]:[]},d.prototype.getLowerBoundMatcher=function(a){var b=this;return a.hasOwnProperty("$gt")||a.hasOwnProperty("$gte")?a.hasOwnProperty("$gt")&&a.hasOwnProperty("$gte")?0===b.compareKeys(a.$gte,a.$gt)?function(c){return b.compareKeys(c,a.$gt)>0}:b.compareKeys(a.$gte,a.$gt)>0?function(c){return b.compareKeys(c,a.$gte)>=0}:function(c){return b.compareKeys(c,a.$gt)>0}:a.hasOwnProperty("$gt")?function(c){return b.compareKeys(c,a.$gt)>0}:function(c){return b.compareKeys(c,a.$gte)>=0}:function(){return!0}},d.prototype.getUpperBoundMatcher=function(a){var b=this;return a.hasOwnProperty("$lt")||a.hasOwnProperty("$lte")?a.hasOwnProperty("$lt")&&a.hasOwnProperty("$lte")?0===b.compareKeys(a.$lte,a.$lt)?function(c){return b.compareKeys(c,a.$lt)<0}:b.compareKeys(a.$lte,a.$lt)<0?function(c){return b.compareKeys(c,a.$lte)<=0}:function(c){return b.compareKeys(c,a.$lt)<0}:a.hasOwnProperty("$lt")?function(c){return b.compareKeys(c,a.$lt)<0}:function(c){return b.compareKeys(c,a.$lte)<=0}:function(){return!0}},d.prototype.betweenBounds=function(a,b,c){var d=[];return this.hasOwnProperty("key")?(b=b||this.getLowerBoundMatcher(a),c=c||this.getUpperBoundMatcher(a),b(this.key)&&this.left&&e(d,this.left.betweenBounds(a,b,c)),b(this.key)&&c(this.key)&&e(d,this.data),c(this.key)&&this.right&&e(d,this.right.betweenBounds(a,b,c)),d):[]},d.prototype.deleteIfLeaf=function(){return this.left||this.right?!1:this.parent?(this.parent.left===this?this.parent.left=null:this.parent.right=null,!0):(delete this.key,this.data=[],!0)},d.prototype.deleteIfOnlyOneChild=function(){var a;return this.left&&!this.right&&(a=this.left),!this.left&&this.right&&(a=this.right),a?this.parent?(this.parent.left===this?(this.parent.left=a,a.parent=this.parent):(this.parent.right=a,a.parent=this.parent),!0):(this.key=a.key,this.data=a.data,this.left=null,a.left&&(this.left=a.left,a.left.parent=this),this.right=null,a.right&&(this.right=a.right,a.right.parent=this),!0):!1},d.prototype["delete"]=function(a,b){var c,d=[],e=this;if(this.hasOwnProperty("key")){if(this.compareKeys(a,this.key)<0)return void(this.left&&this.left["delete"](a,b));if(this.compareKeys(a,this.key)>0)return void(this.right&&this.right["delete"](a,b));if(0!==!this.compareKeys(a,this.key))return this.data.length>1&&void 0!==b?(this.data.forEach(function(a){e.checkValueEquality(a,b)||d.push(a)}),void(e.data=d)):void(this.deleteIfLeaf()||this.deleteIfOnlyOneChild()||(Math.random()>=.5?(c=this.left.getMaxKeyDescendant(),this.key=c.key,this.data=c.data,this===c.parent?(this.left=c.left,c.left&&(c.left.parent=c.parent)):(c.parent.right=c.left,c.left&&(c.left.parent=c.parent))):(c=this.right.getMinKeyDescendant(),this.key=c.key,this.data=c.data,this===c.parent?(this.right=c.right,c.right&&(c.right.parent=c.parent)):(c.parent.left=c.right,c.right&&(c.right.parent=c.parent)))))}},d.prototype.executeOnEveryNode=function(a){this.left&&this.left.executeOnEveryNode(a),a(this),this.right&&this.right.executeOnEveryNode(a)},d.prototype.prettyPrint=function(a,b){b=b||"",console.log(b+"* "+this.key),a&&console.log(b+"* "+this.data),(this.left||this.right)&&(this.left?this.left.prettyPrint(a,b+"  "):console.log(b+"  *"),this.right?this.right.prettyPrint(a,b+"  "):console.log(b+"  *"))},b.exports=d},{"./customUtils":5}],5:[function(a,b,c){function d(a){var b,c;return 0===a?[]:1===a?[0]:(b=d(a-1),c=Math.floor(Math.random()*a),b.splice(c,0,a-1),b)}function e(a,b){if(b>a)return-1;if(a>b)return 1;if(a===b)return 0;var c=new Error("Couldn't compare elements");throw c.a=a,c.b=b,c}function f(a,b){return a===b}b.exports.getRandomArray=d,b.exports.defaultCompareKeysFunction=e,b.exports.defaultCheckValueEquality=f},{}],6:[function(a,b,c){(function(){var a=this,d=a._,e={},f=Array.prototype,g=Object.prototype,h=Function.prototype,i=f.push,j=f.slice,k=f.concat,l=g.toString,m=g.hasOwnProperty,n=f.forEach,o=f.map,p=f.reduce,q=f.reduceRight,r=f.filter,s=f.every,t=f.some,u=f.indexOf,v=f.lastIndexOf,w=Array.isArray,x=Object.keys,y=h.bind,z=function(a){return a instanceof z?a:this instanceof z?void(this._wrapped=a):new z(a)};"undefined"!=typeof c?("undefined"!=typeof b&&b.exports&&(c=b.exports=z),c._=z):a._=z,z.VERSION="1.4.4";var A=z.each=z.forEach=function(a,b,c){if(null!=a)if(n&&a.forEach===n)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,f=a.length;f>d;d++)if(b.call(c,a[d],d,a)===e)return}else for(var g in a)if(z.has(a,g)&&b.call(c,a[g],g,a)===e)return};z.map=z.collect=function(a,b,c){var d=[];return null==a?d:o&&a.map===o?a.map(b,c):(A(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)};var B="Reduce of empty array with no initial value";z.reduce=z.foldl=z.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),p&&a.reduce===p)return d&&(b=z.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(A(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(B);return c},z.reduceRight=z.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),q&&a.reduceRight===q)return d&&(b=z.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=z.keys(a);f=g.length}if(A(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(B);return c},z.find=z.detect=function(a,b,c){var d;return C(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},z.filter=z.select=function(a,b,c){var d=[];return null==a?d:r&&a.filter===r?a.filter(b,c):(A(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},z.reject=function(a,b,c){return z.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},z.every=z.all=function(a,b,c){b||(b=z.identity);var d=!0;return null==a?d:s&&a.every===s?a.every(b,c):(A(a,function(a,f,g){return(d=d&&b.call(c,a,f,g))?void 0:e}),!!d)};var C=z.some=z.any=function(a,b,c){b||(b=z.identity);var d=!1;return null==a?d:t&&a.some===t?a.some(b,c):(A(a,function(a,f,g){return d||(d=b.call(c,a,f,g))?e:void 0}),!!d)};z.contains=z.include=function(a,b){return null==a?!1:u&&a.indexOf===u?-1!=a.indexOf(b):C(a,function(a){return a===b})},z.invoke=function(a,b){var c=j.call(arguments,2),d=z.isFunction(b);return z.map(a,function(a){return(d?b:a[b]).apply(a,c)})},z.pluck=function(a,b){return z.map(a,function(a){return a[b]})},z.where=function(a,b,c){return z.isEmpty(b)?c?null:[]:z[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},z.findWhere=function(a,b){return z.where(a,b,!0)},z.max=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&z.isEmpty(a))return-(1/0);var d={computed:-(1/0),value:-(1/0)};return A(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},z.min=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&z.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return A(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},z.shuffle=function(a){var b,c=0,d=[];return A(a,function(a){b=z.random(c++),d[c-1]=d[b],d[b]=a}),d};var D=function(a){return z.isFunction(a)?a:function(b){return b[a]}};z.sortBy=function(a,b,c){var d=D(b);return z.pluck(z.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var E=function(a,b,c,d){var e={},f=D(b||z.identity);return A(a,function(b,g){var h=f.call(c,b,g,a);d(e,h,b)}),e};z.groupBy=function(a,b,c){return E(a,b,c,function(a,b,c){(z.has(a,b)?a[b]:a[b]=[]).push(c)})},z.countBy=function(a,b,c){return E(a,b,c,function(a,b){z.has(a,b)||(a[b]=0),a[b]++})},z.sortedIndex=function(a,b,c,d){c=null==c?z.identity:D(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},z.toArray=function(a){return a?z.isArray(a)?j.call(a):a.length===+a.length?z.map(a,z.identity):z.values(a):[]},z.size=function(a){return null==a?0:a.length===+a.length?a.length:z.keys(a).length},z.first=z.head=z.take=function(a,b,c){return null!=a?null==b||c?a[0]:j.call(a,0,b):void 0},z.initial=function(a,b,c){return j.call(a,0,a.length-(null==b||c?1:b))},z.last=function(a,b,c){return null!=a?null==b||c?a[a.length-1]:j.call(a,Math.max(a.length-b,0)):void 0},z.rest=z.tail=z.drop=function(a,b,c){return j.call(a,null==b||c?1:b)},z.compact=function(a){return z.filter(a,z.identity)};var F=function(a,b,c){return A(a,function(a){z.isArray(a)?b?i.apply(c,a):F(a,b,c):c.push(a)}),c};z.flatten=function(a,b){return F(a,b,[])},z.without=function(a){return z.difference(a,j.call(arguments,1))},z.uniq=z.unique=function(a,b,c,d){z.isFunction(b)&&(d=c,c=b,b=!1);var e=c?z.map(a,c,d):a,f=[],g=[];return A(e,function(c,d){(b?d&&g[g.length-1]===c:z.contains(g,c))||(g.push(c),f.push(a[d]))}),f},z.union=function(){return z.uniq(k.apply(f,arguments))},z.intersection=function(a){var b=j.call(arguments,1);return z.filter(z.uniq(a),function(a){return z.every(b,function(b){return z.indexOf(b,a)>=0})})},z.difference=function(a){var b=k.apply(f,j.call(arguments,1));return z.filter(a,function(a){return!z.contains(b,a)})},z.zip=function(){for(var a=j.call(arguments),b=z.max(z.pluck(a,"length")),c=new Array(b),d=0;b>d;d++)c[d]=z.pluck(a,""+d);return c},z.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},z.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=z.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(u&&a.indexOf===u)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},z.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(v&&a.lastIndexOf===v)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},z.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f},z.bind=function(a,b){if(a.bind===y&&y)return y.apply(a,j.call(arguments,1));var c=j.call(arguments,2);return function(){return a.apply(b,c.concat(j.call(arguments)))}},z.partial=function(a){var b=j.call(arguments,1);return function(){return a.apply(this,b.concat(j.call(arguments)))}},z.bindAll=function(a){var b=j.call(arguments,1);return 0===b.length&&(b=z.functions(a)),A(b,function(b){a[b]=z.bind(a[b],a)}),a},z.memoize=function(a,b){var c={};return b||(b=z.identity),function(){var d=b.apply(this,arguments);return z.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},z.delay=function(a,b){var c=j.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},z.defer=function(a){return z.delay.apply(z,[a,1].concat(j.call(arguments,1)))},z.throttle=function(a,b){var c,d,e,f,g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)};return function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,0>=j?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},z.debounce=function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=function(){d=null,c||(e=a.apply(f,g))},i=c&&!d;return clearTimeout(d),d=setTimeout(h,b),i&&(e=a.apply(f,g)),e}},z.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},z.wrap=function(a,b){return function(){var c=[a];return i.apply(c,arguments),b.apply(this,c)}},z.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},z.after=function(a,b){return 0>=a?b():function(){return--a<1?b.apply(this,arguments):void 0}},z.keys=x||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)z.has(a,c)&&(b[b.length]=c);return b},z.values=function(a){var b=[];for(var c in a)z.has(a,c)&&b.push(a[c]);return b},z.pairs=function(a){var b=[];for(var c in a)z.has(a,c)&&b.push([c,a[c]]);return b},z.invert=function(a){var b={};for(var c in a)z.has(a,c)&&(b[a[c]]=c);return b},z.functions=z.methods=function(a){var b=[];for(var c in a)z.isFunction(a[c])&&b.push(c);return b.sort()},z.extend=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},z.pick=function(a){var b={},c=k.apply(f,j.call(arguments,1));return A(c,function(c){c in a&&(b[c]=a[c])}),b},z.omit=function(a){var b={},c=k.apply(f,j.call(arguments,1));for(var d in a)z.contains(c,d)||(b[d]=a[d]);return b},z.defaults=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)null==a[c]&&(a[c]=b[c])}),a},z.clone=function(a){return z.isObject(a)?z.isArray(a)?a.slice():z.extend({},a):a},z.tap=function(a,b){return b(a),a};var G=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof z&&(a=a._wrapped),b instanceof z&&(b=b._wrapped);var e=l.call(a);if(e!=l.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;c.push(a),d.push(b);var g=0,h=!0;if("[object Array]"==e){if(g=a.length,h=g==b.length)for(;g--&&(h=G(a[g],b[g],c,d)););}else{var i=a.constructor,j=b.constructor;if(i!==j&&!(z.isFunction(i)&&i instanceof i&&z.isFunction(j)&&j instanceof j))return!1;for(var k in a)if(z.has(a,k)&&(g++,!(h=z.has(b,k)&&G(a[k],b[k],c,d))))break;if(h){for(k in b)if(z.has(b,k)&&!g--)break;h=!g}}return c.pop(),d.pop(),h};z.isEqual=function(a,b){return G(a,b,[],[])},z.isEmpty=function(a){if(null==a)return!0;if(z.isArray(a)||z.isString(a))return 0===a.length;for(var b in a)if(z.has(a,b))return!1;return!0},z.isElement=function(a){return!(!a||1!==a.nodeType)},z.isArray=w||function(a){return"[object Array]"==l.call(a)},z.isObject=function(a){return a===Object(a)},A(["Arguments","Function","String","Number","Date","RegExp"],function(a){z["is"+a]=function(b){return l.call(b)=="[object "+a+"]"}}),z.isArguments(arguments)||(z.isArguments=function(a){return!(!a||!z.has(a,"callee"))}),"function"!=typeof/./&&(z.isFunction=function(a){return"function"==typeof a}),z.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},z.isNaN=function(a){return z.isNumber(a)&&a!=+a},z.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==l.call(a)},z.isNull=function(a){return null===a},z.isUndefined=function(a){return void 0===a},z.has=function(a,b){return m.call(a,b)},z.noConflict=function(){return a._=d,this},z.identity=function(a){return a},z.times=function(a,b,c){for(var d=Array(a),e=0;a>e;e++)d[e]=b.call(c,e);return d},z.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var H={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};H.unescape=z.invert(H.escape);var I={escape:new RegExp("["+z.keys(H.escape).join("")+"]","g"),unescape:new RegExp("("+z.keys(H.unescape).join("|")+")","g")};z.each(["escape","unescape"],function(a){z[a]=function(b){return null==b?"":(""+b).replace(I[a],function(b){return H[a][b]})}}),z.result=function(a,b){if(null==a)return null;var c=a[b];return z.isFunction(c)?c.call(a):c},z.mixin=function(a){A(z.functions(a),function(b){var c=z[b]=a[b];z.prototype[b]=function(){var a=[this._wrapped];return i.apply(a,arguments),N.call(this,c.apply(z,a))}})};var J=0;z.uniqueId=function(a){var b=++J+"";return a?a+b:b},z.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var K=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},M=/\\|'|\r|\n|\t|\u2028|\u2029/g;z.template=function(a,b,c){var d;c=z.defaults({},c,z.templateSettings);var e=new RegExp([(c.escape||K).source,(c.interpolate||K).source,(c.evaluate||K).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(M,function(a){return"\\"+L[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,z);var i=function(a){return d.call(this,a,z)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},z.chain=function(a){return z(a).chain()};var N=function(a){return this._chain?z(a).chain():a};z.mixin(z),A(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=f[a];z.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],N.call(this,c)}}),A(["concat","join","slice"],function(a){var b=f[a];z.prototype[a]=function(){return N.call(this,b.apply(this._wrapped,arguments))}}),z.extend(z.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}],7:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],8:[function(b,c,d){(function(b,e){/*!
    localForage -- Offline Storage, Improved
    Version 1.3.1
    https://mozilla.github.io/localForage
    (c) 2013-2015 Mozilla, Apache License 2.0
*/
!function(){var a,c,d,f;!function(){var b={},e={};a=function(a,c,d){b[a]={deps:c,callback:d}},f=d=c=function(a){function d(b){if("."!==b.charAt(0))return b;for(var c=b.split("/"),d=a.split("/").slice(0,-1),e=0,f=c.length;f>e;e++){var g=c[e];if(".."===g)d.pop();else{if("."===g)continue;d.push(g)}}return d.join("/")}if(f._eak_seen=b,e[a])return e[a];if(e[a]={},!b[a])throw new Error("Could not find module "+a);for(var g,h=b[a],i=h.deps,j=h.callback,k=[],l=0,m=i.length;m>l;l++)"exports"===i[l]?k.push(g={}):k.push(c(d(i[l])));var n=j.apply(this,k);return e[a]=g||n}}(),a("promise/all",["./utils","exports"],function(a,b){"use strict";function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to all.");return new b(function(b,c){function d(a){return function(b){f(a,b)}}function f(a,c){h[a]=c,0===--i&&b(h)}var g,h=[],i=a.length;0===i&&b([]);for(var j=0;j<a.length;j++)g=a[j],g&&e(g.then)?g.then(d(j),c):f(j,g)})}var d=a.isArray,e=a.isFunction;b.all=c}),a("promise/asap",["exports"],function(a){"use strict";function c(){return function(){b.nextTick(g)}}function d(){var a=0,b=new k(g),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function f(){return function(){l.setTimeout(g,1)}}function g(){for(var a=0;a<m.length;a++){var b=m[a],c=b[0],d=b[1];c(d)}m=[]}function h(a,b){var c=m.push([a,b]);1===c&&i()}var i,j="undefined"!=typeof window?window:{},k=j.MutationObserver||j.WebKitMutationObserver,l="undefined"!=typeof e?e:void 0===this?window:this,m=[];i="undefined"!=typeof b&&"[object process]"==={}.toString.call(b)?c():k?d():f(),a.asap=h}),a("promise/config",["exports"],function(a){"use strict";function b(a,b){return 2!==arguments.length?c[a]:void(c[a]=b)}var c={instrument:!1};a.config=c,a.configure=b}),a("promise/polyfill",["./promise","./utils","exports"],function(a,b,c){"use strict";function d(){var a;a="undefined"!=typeof e?e:"undefined"!=typeof window&&window.document?window:self;var b="Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var b;return new a.Promise(function(a){b=a}),g(b)}();b||(a.Promise=f)}var f=a.Promise,g=b.isFunction;c.polyfill=d}),a("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(a,b,c,d,e,f,g,h){"use strict";function i(a){if(!v(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof i))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],j(a,this)}function j(a,b){function c(a){o(b,a)}function d(a){q(b,a)}try{a(c,d)}catch(e){d(e)}}function k(a,b,c,d){var e,f,g,h,i=v(c);if(i)try{e=c(d),g=!0}catch(j){h=!0,f=j}else e=d,g=!0;n(b,e)||(i&&g?o(b,e):h?q(b,f):a===D?o(b,e):a===E&&q(b,e))}function l(a,b,c,d){var e=a._subscribers,f=e.length;e[f]=b,e[f+D]=c,e[f+E]=d}function m(a,b){for(var c,d,e=a._subscribers,f=a._detail,g=0;g<e.length;g+=3)c=e[g],d=e[g+b],k(b,c,d,f);a._subscribers=null}function n(a,b){var c,d=null;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");if(u(b)&&(d=b.then,v(d)))return d.call(b,function(d){return c?!0:(c=!0,void(b!==d?o(a,d):p(a,d)))},function(b){return c?!0:(c=!0,void q(a,b))}),!0}catch(e){return c?!0:(q(a,e),!0)}return!1}function o(a,b){a===b?p(a,b):n(a,b)||p(a,b)}function p(a,b){a._state===B&&(a._state=C,a._detail=b,t.async(r,a))}function q(a,b){a._state===B&&(a._state=C,a._detail=b,t.async(s,a))}function r(a){m(a,a._state=D)}function s(a){m(a,a._state=E)}var t=a.config,u=(a.configure,b.objectOrFunction),v=b.isFunction,w=(b.now,c.all),x=d.race,y=e.resolve,z=f.reject,A=g.asap;t.async=A;var B=void 0,C=0,D=1,E=2;i.prototype={constructor:i,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(a,b){var c=this,d=new this.constructor(function(){});if(this._state){var e=arguments;t.async(function(){k(c._state,d,e[c._state-1],c._detail)})}else l(this,d,a,b);return d},"catch":function(a){return this.then(null,a)}},i.all=w,i.race=x,i.resolve=y,i.reject=z,h.Promise=i}),a("promise/race",["./utils","exports"],function(a,b){"use strict";function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to race.");return new b(function(b,c){for(var d,e=0;e<a.length;e++)d=a[e],d&&"function"==typeof d.then?d.then(b,c):b(d)})}var d=a.isArray;b.race=c}),a("promise/reject",["exports"],function(a){"use strict";function b(a){var b=this;return new b(function(b,c){c(a)})}a.reject=b}),a("promise/resolve",["exports"],function(a){"use strict";function b(a){if(a&&"object"==typeof a&&a.constructor===this)return a;var b=this;return new b(function(b){b(a)})}a.resolve=b}),a("promise/utils",["exports"],function(a){"use strict";function b(a){return c(a)||"object"==typeof a&&null!==a}function c(a){return"function"==typeof a}function d(a){return"[object Array]"===Object.prototype.toString.call(a)}var e=Date.now||function(){return(new Date).getTime()};a.objectOrFunction=b,a.isFunction=c,a.isArray=d,a.now=e}),c("promise/polyfill").polyfill()}(),function(b,e){"object"==typeof d&&"object"==typeof c?c.exports=e():"function"==typeof a&&a.amd?a([],e):"object"==typeof d?d.localforage=e():b.localforage=e()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}b.__esModule=!0,function(){function a(a,b){a[b]=function(){var c=arguments;return a.ready().then(function(){return a[b].apply(a,c)})}}function e(){for(var a=1;a<arguments.length;a++){var b=arguments[a];if(b)for(var c in b)b.hasOwnProperty(c)&&(m(b[c])?arguments[0][c]=b[c].slice():arguments[0][c]=b[c])}return arguments[0]}function f(a){for(var b in h)if(h.hasOwnProperty(b)&&h[b]===a)return!0;return!1}var g={},h={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},i=[h.INDEXEDDB,h.WEBSQL,h.LOCALSTORAGE],j=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],k={description:"",driver:i.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},l=function(a){var b=b||a.indexedDB||a.webkitIndexedDB||a.mozIndexedDB||a.OIndexedDB||a.msIndexedDB,c={};return c[h.WEBSQL]=!!a.openDatabase,c[h.INDEXEDDB]=!!function(){if("undefined"!=typeof a.openDatabase&&a.navigator&&a.navigator.userAgent&&/Safari/.test(a.navigator.userAgent)&&!/Chrome/.test(a.navigator.userAgent))return!1;try{return b&&"function"==typeof b.open&&"undefined"!=typeof a.IDBKeyRange}catch(c){return!1}}(),c[h.LOCALSTORAGE]=!!function(){try{return a.localStorage&&"setItem"in a.localStorage&&a.localStorage.setItem}catch(b){return!1}}(),c}(this),m=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},n=function(){function b(a){d(this,b),this.INDEXEDDB=h.INDEXEDDB,this.LOCALSTORAGE=h.LOCALSTORAGE,this.WEBSQL=h.WEBSQL,this._defaultConfig=e({},k),this._config=e({},this._defaultConfig,a),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return b.prototype.config=function(a){if("object"==typeof a){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var b in a)"storeName"===b&&(a[b]=a[b].replace(/\W/g,"_")),this._config[b]=a[b];return"driver"in a&&a.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof a?this._config[a]:this._config},b.prototype.defineDriver=function(a,b,c){var d=new Promise(function(b,c){try{var d=a._driver,e=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),h=new Error("Custom driver name already in use: "+a._driver);if(!a._driver)return void c(e);if(f(a._driver))return void c(h);for(var i=j.concat("_initStorage"),k=0;k<i.length;k++){var m=i[k];if(!m||!a[m]||"function"!=typeof a[m])return void c(e)}var n=Promise.resolve(!0);"_support"in a&&(n=a._support&&"function"==typeof a._support?a._support():Promise.resolve(!!a._support)),n.then(function(c){l[d]=c,g[d]=a,b()},c)}catch(o){c(o)}});return d.then(b,c),d},b.prototype.driver=function(){return this._driver||null},b.prototype.getDriver=function(a,b,d){var e=this,h=function(){if(f(a))switch(a){case e.INDEXEDDB:return new Promise(function(a,b){a(c(1))});case e.LOCALSTORAGE:return new Promise(function(a,b){a(c(2))});case e.WEBSQL:return new Promise(function(a,b){a(c(4))})}else if(g[a])return Promise.resolve(g[a]);return Promise.reject(new Error("Driver not found."))}();return h.then(b,d),h},b.prototype.getSerializer=function(a){var b=new Promise(function(a,b){a(c(3))});return a&&"function"==typeof a&&b.then(function(b){a(b)}),b},b.prototype.ready=function(a){var b=this,c=b._driverSet.then(function(){return null===b._ready&&(b._ready=b._initDriver()),b._ready});return c.then(a,a),c},b.prototype.setDriver=function(a,b,c){function d(){f._config.driver=f.driver()}function e(a){return function(){function b(){for(;c<a.length;){var e=a[c];return c++,f._dbInfo=null,f._ready=null,f.getDriver(e).then(function(a){return f._extend(a),d(),f._ready=f._initStorage(f._config),f._ready})["catch"](b)}d();var g=new Error("No available storage method found.");return f._driverSet=Promise.reject(g),f._driverSet}var c=0;return b()}}var f=this;m(a)||(a=[a]);var g=this._getSupportedDrivers(a),h=null!==this._driverSet?this._driverSet["catch"](function(){return Promise.resolve()}):Promise.resolve();return this._driverSet=h.then(function(){var a=g[0];return f._dbInfo=null,f._ready=null,f.getDriver(a).then(function(a){f._driver=a._driver,d(),f._wrapLibraryMethodsWithReady(),f._initDriver=e(g)})})["catch"](function(){d();var a=new Error("No available storage method found.");return f._driverSet=Promise.reject(a),f._driverSet}),this._driverSet.then(b,c),this._driverSet},b.prototype.supports=function(a){return!!l[a]},b.prototype._extend=function(a){e(this,a)},b.prototype._getSupportedDrivers=function(a){for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c];this.supports(e)&&b.push(e)}return b},b.prototype._wrapLibraryMethodsWithReady=function(){for(var b=0;b<j.length;b++)a(this,j[b])},b.prototype.createInstance=function(a){return new b(a)},b}(),o=new n;b["default"]=o}.call("undefined"!=typeof window?window:self),a.exports=b["default"]},function(a,b){"use strict";b.__esModule=!0,function(){function a(a,b){a=a||[],b=b||{};try{return new Blob(a,b)}catch(c){if("TypeError"!==c.name)throw c;for(var d=x.BlobBuilder||x.MSBlobBuilder||x.MozBlobBuilder||x.WebKitBlobBuilder,e=new d,f=0;f<a.length;f+=1)e.append(a[f]);return e.getBlob(b.type)}}function c(a){for(var b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c),e=0;b>e;e++)d[e]=a.charCodeAt(e);return c}function d(a){return new Promise(function(b,c){var d=new XMLHttpRequest;d.open("GET",a),d.withCredentials=!0,d.responseType="arraybuffer",d.onreadystatechange=function(){return 4===d.readyState?200===d.status?b({response:d.response,type:d.getResponseHeader("Content-Type")}):void c({status:d.status,response:d.response}):void 0},d.send()})}function e(b){return new Promise(function(c,e){var f=a([""],{type:"image/png"}),g=b.transaction([B],"readwrite");g.objectStore(B).put(f,"key"),g.oncomplete=function(){var a=b.transaction([B],"readwrite"),f=a.objectStore(B).get("key");f.onerror=e,f.onsuccess=function(a){var b=a.target.result,e=URL.createObjectURL(b);d(e).then(function(a){c(!(!a||"image/png"!==a.type))},function(){c(!1)}).then(function(){URL.revokeObjectURL(e)})}}})["catch"](function(){return!1})}function f(a){return"boolean"==typeof z?Promise.resolve(z):e(a).then(function(a){return z=a})}function g(a){return new Promise(function(b,c){var d=new FileReader;d.onerror=c,d.onloadend=function(c){var d=btoa(c.target.result||"");b({__local_forage_encoded_blob:!0,data:d,type:a.type})},d.readAsBinaryString(a)})}function h(b){var d=c(atob(b.data));return a([d],{type:b.type})}function i(a){return a&&a.__local_forage_encoded_blob}function j(a){function b(){return Promise.resolve()}var c=this,d={db:null};if(a)for(var e in a)d[e]=a[e];A||(A={});var f=A[d.name];f||(f={forages:[],db:null},A[d.name]=f),f.forages.push(this);for(var g=[],h=0;h<f.forages.length;h++){var i=f.forages[h];i!==this&&g.push(i.ready()["catch"](b))}var j=f.forages.slice(0);return Promise.all(g).then(function(){return d.db=f.db,k(d)}).then(function(a){return d.db=a,n(d,c._defaultConfig.version)?l(d):a}).then(function(a){d.db=f.db=a,c._dbInfo=d;for(var b=0;b<j.length;b++){var e=j[b];e!==c&&(e._dbInfo.db=d.db,e._dbInfo.version=d.version)}})}function k(a){return m(a,!1)}function l(a){return m(a,!0)}function m(a,b){return new Promise(function(c,d){if(a.db){if(!b)return c(a.db);a.db.close()}var e=[a.name];b&&e.push(a.version);var f=y.open.apply(y,e);b&&(f.onupgradeneeded=function(b){var c=f.result;try{c.createObjectStore(a.storeName),b.oldVersion<=1&&c.createObjectStore(B)}catch(d){if("ConstraintError"!==d.name)throw d;x.console.warn('The database "'+a.name+'" has been upgraded from version '+b.oldVersion+" to version "+b.newVersion+', but the storage "'+a.storeName+'" already exists.')}}),f.onerror=function(){d(f.error)},f.onsuccess=function(){c(f.result)}})}function n(a,b){if(!a.db)return!0;var c=!a.db.objectStoreNames.contains(a.storeName),d=a.version<a.db.version,e=a.version>a.db.version;if(d&&(a.version!==b&&x.console.warn('The database "'+a.name+"\" can't be downgraded from version "+a.db.version+" to version "+a.version+"."),a.version=a.db.version),e||c){if(c){var f=a.db.version+1;f>a.version&&(a.version=f)}return!0}return!1}function o(a,b){var c=this;"string"!=typeof a&&(x.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=new Promise(function(b,d){c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,"readonly").objectStore(e.storeName),g=f.get(a);g.onsuccess=function(){var a=g.result;void 0===a&&(a=null),i(a)&&(a=h(a)),b(a)},g.onerror=function(){d(g.error)}})["catch"](d)});return w(d,b),d}function p(a,b){var c=this,d=new Promise(function(b,d){c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,"readonly").objectStore(e.storeName),g=f.openCursor(),j=1;g.onsuccess=function(){var c=g.result;if(c){var d=c.value;i(d)&&(d=h(d));var e=a(d,c.key,j++);void 0!==e?b(e):c["continue"]()}else b()},g.onerror=function(){d(g.error)}})["catch"](d)});return w(d,b),d}function q(a,b,c){var d=this;"string"!=typeof a&&(x.console.warn(a+" used as a key, but it is not a string."),a=String(a));var e=new Promise(function(c,e){var h;d.ready().then(function(){return h=d._dbInfo,b instanceof Blob?f(h.db).then(function(a){return a?b:g(b)}):b}).then(function(b){var d=h.db.transaction(h.storeName,"readwrite"),f=d.objectStore(h.storeName);null===b&&(b=void 0);var g=f.put(b,a);d.oncomplete=function(){void 0===b&&(b=null),c(b)},d.onabort=d.onerror=function(){var a=g.error?g.error:g.transaction.error;e(a)}})["catch"](e)});return w(e,c),e}function r(a,b){var c=this;"string"!=typeof a&&(x.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=new Promise(function(b,d){c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,"readwrite"),g=f.objectStore(e.storeName),h=g["delete"](a);f.oncomplete=function(){b()},f.onerror=function(){d(h.error)},f.onabort=function(){var a=h.error?h.error:h.transaction.error;d(a)}})["catch"](d)});return w(d,b),d}function s(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){var d=b._dbInfo,e=d.db.transaction(d.storeName,"readwrite"),f=e.objectStore(d.storeName),g=f.clear();e.oncomplete=function(){a()},e.onabort=e.onerror=function(){var a=g.error?g.error:g.transaction.error;c(a)}})["catch"](c)});return w(c,a),c}function t(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){var d=b._dbInfo,e=d.db.transaction(d.storeName,"readonly").objectStore(d.storeName),f=e.count();f.onsuccess=function(){a(f.result)},f.onerror=function(){c(f.error)}})["catch"](c)});return w(c,a),c}function u(a,b){var c=this,d=new Promise(function(b,d){return 0>a?void b(null):void c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,"readonly").objectStore(e.storeName),g=!1,h=f.openCursor();h.onsuccess=function(){var c=h.result;return c?void(0===a?b(c.key):g?b(c.key):(g=!0,c.advance(a))):void b(null)},h.onerror=function(){d(h.error)}})["catch"](d)});return w(d,b),d}function v(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){var d=b._dbInfo,e=d.db.transaction(d.storeName,"readonly").objectStore(d.storeName),f=e.openCursor(),g=[];f.onsuccess=function(){var b=f.result;return b?(g.push(b.key),void b["continue"]()):void a(g)},f.onerror=function(){c(f.error)}})["catch"](c)});return w(c,a),c}function w(a,b){b&&a.then(function(a){b(null,a)},function(a){b(a)})}var x=this,y=y||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB;if(y){var z,A,B="local-forage-detect-blob-support",C={_driver:"asyncStorage",_initStorage:j,iterate:p,getItem:o,setItem:q,removeItem:r,clear:s,length:t,key:u,keys:v};b["default"]=C}}.call("undefined"!=typeof window?window:self),a.exports=b["default"]},function(a,b,c){"use strict";b.__esModule=!0,function(){function a(a){var b=this,d={};if(a)for(var e in a)d[e]=a[e];return d.keyPrefix=d.name+"/",d.storeName!==b._defaultConfig.storeName&&(d.keyPrefix+=d.storeName+"/"),b._dbInfo=d,new Promise(function(a,b){a(c(3))}).then(function(a){return d.serializer=a,Promise.resolve()})}function d(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo.keyPrefix,c=n.length-1;c>=0;c--){var d=n.key(c);0===d.indexOf(a)&&n.removeItem(d)}});return l(c,a),c}function e(a,b){var c=this;"string"!=typeof a&&(m.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=c.ready().then(function(){var b=c._dbInfo,d=n.getItem(b.keyPrefix+a);return d&&(d=b.serializer.deserialize(d)),d});return l(d,b),d}function f(a,b){var c=this,d=c.ready().then(function(){for(var b=c._dbInfo,d=b.keyPrefix,e=d.length,f=n.length,g=1,h=0;f>h;h++){var i=n.key(h);if(0===i.indexOf(d)){var j=n.getItem(i);if(j&&(j=b.serializer.deserialize(j)),j=a(j,i.substring(e),g++),void 0!==j)return j}}});return l(d,b),d}function g(a,b){var c=this,d=c.ready().then(function(){var b,d=c._dbInfo;try{b=n.key(a)}catch(e){b=null}return b&&(b=b.substring(d.keyPrefix.length)),b});return l(d,b),d}function h(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo,c=n.length,d=[],e=0;c>e;e++)0===n.key(e).indexOf(a.keyPrefix)&&d.push(n.key(e).substring(a.keyPrefix.length));return d});return l(c,a),c}function i(a){var b=this,c=b.keys().then(function(a){return a.length});return l(c,a),c}function j(a,b){var c=this;"string"!=typeof a&&(m.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=c.ready().then(function(){var b=c._dbInfo;n.removeItem(b.keyPrefix+a)});return l(d,b),d}function k(a,b,c){var d=this;"string"!=typeof a&&(m.console.warn(a+" used as a key, but it is not a string."),a=String(a));var e=d.ready().then(function(){void 0===b&&(b=null);var c=b;return new Promise(function(e,f){var g=d._dbInfo;g.serializer.serialize(b,function(b,d){if(d)f(d);else try{n.setItem(g.keyPrefix+a,b),e(c)}catch(h){("QuotaExceededError"===h.name||"NS_ERROR_DOM_QUOTA_REACHED"===h.name)&&f(h),f(h)}})})});return l(e,c),e}function l(a,b){b&&a.then(function(a){b(null,a)},function(a){b(a)})}var m=this,n=null;try{if(!(this.localStorage&&"setItem"in this.localStorage))return;n=this.localStorage}catch(o){return}var p={_driver:"localStorageWrapper",_initStorage:a,iterate:f,getItem:e,setItem:k,removeItem:j,clear:d,length:i,key:g,keys:h};b["default"]=p}.call("undefined"!=typeof window?window:self),a.exports=b["default"]},function(a,b){"use strict";b.__esModule=!0,function(){function a(a,b){a=a||[],b=b||{};try{return new Blob(a,b)}catch(c){if("TypeError"!==c.name)throw c;for(var d=x.BlobBuilder||x.MSBlobBuilder||x.MozBlobBuilder||x.WebKitBlobBuilder,e=new d,f=0;f<a.length;f+=1)e.append(a[f]);return e.getBlob(b.type)}}function c(a,b){var c="";if(a&&(c=a.toString()),a&&("[object ArrayBuffer]"===a.toString()||a.buffer&&"[object ArrayBuffer]"===a.buffer.toString())){var d,e=j;a instanceof ArrayBuffer?(d=a,e+=l):(d=a.buffer,"[object Int8Array]"===c?e+=n:"[object Uint8Array]"===c?e+=o:"[object Uint8ClampedArray]"===c?e+=p:"[object Int16Array]"===c?e+=q:"[object Uint16Array]"===c?e+=s:"[object Int32Array]"===c?e+=r:"[object Uint32Array]"===c?e+=t:"[object Float32Array]"===c?e+=u:"[object Float64Array]"===c?e+=v:b(new Error("Failed to get type for BinaryArray"))),b(e+f(d))}else if("[object Blob]"===c){var g=new FileReader;g.onload=function(){var c=h+a.type+"~"+f(this.result);b(j+m+c)},g.readAsArrayBuffer(a)}else try{b(JSON.stringify(a))}catch(i){console.error("Couldn't convert value into a JSON string: ",a),b(null,i)}}function d(b){if(b.substring(0,k)!==j)return JSON.parse(b);var c,d=b.substring(w),f=b.substring(k,w);if(f===m&&i.test(d)){var g=d.match(i);c=g[1],d=d.substring(g[0].length)}var h=e(d);switch(f){case l:return h;case m:return a([h],{type:c});case n:return new Int8Array(h);case o:return new Uint8Array(h);case p:return new Uint8ClampedArray(h);case q:return new Int16Array(h);case s:return new Uint16Array(h);case r:return new Int32Array(h);case t:return new Uint32Array(h);case u:return new Float32Array(h);case v:return new Float64Array(h);default:throw new Error("Unkown type: "+f)}}function e(a){var b,c,d,e,f,h=.75*a.length,i=a.length,j=0;"="===a[a.length-1]&&(h--,"="===a[a.length-2]&&h--);var k=new ArrayBuffer(h),l=new Uint8Array(k);for(b=0;i>b;b+=4)c=g.indexOf(a[b]),d=g.indexOf(a[b+1]),e=g.indexOf(a[b+2]),f=g.indexOf(a[b+3]),l[j++]=c<<2|d>>4,l[j++]=(15&d)<<4|e>>2,l[j++]=(3&e)<<6|63&f;return k}function f(a){var b,c=new Uint8Array(a),d="";for(b=0;b<c.length;b+=3)d+=g[c[b]>>2],d+=g[(3&c[b])<<4|c[b+1]>>4],d+=g[(15&c[b+1])<<2|c[b+2]>>6],d+=g[63&c[b+2]];return c.length%3===2?d=d.substring(0,d.length-1)+"=":c.length%3===1&&(d=d.substring(0,d.length-2)+"=="),d}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="~~local_forage_type~",i=/^~~local_forage_type~([^~]+)~/,j="__lfsc__:",k=j.length,l="arbf",m="blob",n="si08",o="ui08",p="uic8",q="si16",r="si32",s="ur16",t="ui32",u="fl32",v="fl64",w=k+l.length,x=this,y={serialize:c,deserialize:d,stringToBuffer:e,bufferToString:f};b["default"]=y}.call("undefined"!=typeof window?window:self),a.exports=b["default"]},function(a,b,c){"use strict";b.__esModule=!0,function(){function a(a){var b=this,d={db:null};if(a)for(var e in a)d[e]="string"!=typeof a[e]?a[e].toString():a[e];var f=new Promise(function(c,e){try{d.db=n(d.name,String(d.version),d.description,d.size)}catch(f){return b.setDriver(b.LOCALSTORAGE).then(function(){return b._initStorage(a)}).then(c)["catch"](e)}d.db.transaction(function(a){a.executeSql("CREATE TABLE IF NOT EXISTS "+d.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){b._dbInfo=d,c()},function(a,b){e(b)})})});return new Promise(function(a,b){a(c(3))}).then(function(a){return d.serializer=a,f})}function d(a,b){var c=this;"string"!=typeof a&&(m.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=new Promise(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("SELECT * FROM "+e.storeName+" WHERE key = ? LIMIT 1",[a],function(a,c){var d=c.rows.length?c.rows.item(0).value:null;d&&(d=e.serializer.deserialize(d)),b(d)},function(a,b){d(b)})})})["catch"](d)});return l(d,b),d}function e(a,b){var c=this,d=new Promise(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("SELECT * FROM "+e.storeName,[],function(c,d){for(var f=d.rows,g=f.length,h=0;g>h;h++){var i=f.item(h),j=i.value;if(j&&(j=e.serializer.deserialize(j)),j=a(j,i.key,h+1),void 0!==j)return void b(j)}b()},function(a,b){d(b)})})})["catch"](d)});return l(d,b),d}function f(a,b,c){var d=this;"string"!=typeof a&&(m.console.warn(a+" used as a key, but it is not a string."),a=String(a));var e=new Promise(function(c,e){d.ready().then(function(){void 0===b&&(b=null);var f=b,g=d._dbInfo;g.serializer.serialize(b,function(b,d){d?e(d):g.db.transaction(function(d){d.executeSql("INSERT OR REPLACE INTO "+g.storeName+" (key, value) VALUES (?, ?)",[a,b],function(){c(f)},function(a,b){e(b)})},function(a){a.code===a.QUOTA_ERR&&e(a)})})})["catch"](e)});return l(e,c),e}function g(a,b){var c=this;"string"!=typeof a&&(m.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=new Promise(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("DELETE FROM "+e.storeName+" WHERE key = ?",[a],function(){b()},function(a,b){d(b)})})})["catch"](d)});return l(d,b),d}function h(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("DELETE FROM "+d.storeName,[],function(){a()},function(a,b){c(b)})})})["catch"](c)});return l(c,a),c}function i(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("SELECT COUNT(key) as c FROM "+d.storeName,[],function(b,c){var d=c.rows.item(0).c;a(d)},function(a,b){c(b)})})})["catch"](c)});return l(c,a),c}function j(a,b){var c=this,d=new Promise(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("SELECT key FROM "+e.storeName+" WHERE id = ? LIMIT 1",[a+1],function(a,c){var d=c.rows.length?c.rows.item(0).key:null;b(d)},function(a,b){d(b)})})})["catch"](d)});return l(d,b),d}function k(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("SELECT key FROM "+d.storeName,[],function(b,c){for(var d=[],e=0;e<c.rows.length;e++)d.push(c.rows.item(e).key);a(d)},function(a,b){c(b)})})})["catch"](c)});return l(c,a),c}function l(a,b){b&&a.then(function(a){b(null,a)},function(a){b(a)})}var m=this,n=this.openDatabase;if(n){var o={_driver:"webSQLStorage",_initStorage:a,iterate:e,getItem:d,setItem:f,removeItem:g,clear:h,length:i,key:j,keys:k};b["default"]=o}}.call("undefined"!=typeof window?window:self),a.exports=b["default"]}])})}).call(this,b("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:21}],9:[function(a,b,c){function d(a){for(var b,b,c=new Array(a),d=0;a>d;d++)0==(3&d)&&(b=4294967296*Math.random()),c[d]=b>>>((3&d)<<3)&255;return c}function e(a){function b(a){return f[a>>18&63]+f[a>>12&63]+f[a>>6&63]+f[63&a]}var c,d,e,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=a.length%3,h="";for(e=0,d=a.length-g;d>e;e+=3)c=(a[e]<<16)+(a[e+1]<<8)+a[e+2],h+=b(c);switch(g){case 1:c=a[a.length-1],h+=f[c>>2],h+=f[c<<4&63],h+="==";break;case 2:c=(a[a.length-2]<<8)+a[a.length-1],h+=f[c>>10],h+=f[c>>4&63],h+=f[c<<2&63],h+="="}return h}function f(a){return e(d(Math.ceil(Math.max(8,2*a)))).replace(/[+\/]/g,"").slice(0,a)}b.exports.uid=f},{}],10:[function(a,b,c){function d(a,b){l.getItem(a,function(a,c){return b(null!==c?!0:!1)})}function e(a,b,c){l.getItem(a,function(d,e){null===e?l.removeItem(b,function(){return c()}):l.setItem(b,e,function(){l.removeItem(a,function(){return c()})})})}function f(a,b,c,d){"function"==typeof c&&(d=c),l.setItem(a,b,function(){return d()})}function g(a,b,c,d){"function"==typeof c&&(d=c),l.getItem(a,function(c,e){e=e||"",e+=b,l.setItem(a,e,function(){return d()})})}function h(a,b,c){"function"==typeof b&&(c=b),l.getItem(a,function(a,b){return c(null,b||"")})}function i(a,b){l.removeItem(a,function(){return b()})}function j(a,b){return b()}function k(a,b){return b(null)}var l=a("localforage");l.config({name:"NeDB",storeName:"nedbdata"}),b.exports.exists=d,b.exports.rename=e,b.exports.writeFile=f,b.exports.crashSafeWriteFile=f,b.exports.appendFile=g,b.exports.readFile=h,b.exports.unlink=i,b.exports.mkdirp=j,b.exports.ensureDatafileIntegrity=k},{localforage:8}],11:[function(a,b,c){var d=a("./lib/datastore");b.exports=d},{"./lib/datastore":13}],12:[function(a,b,c){function d(a,b,c){this.db=a,this.query=b||{},c&&(this.execFn=c)}var e=a("./model"),f=a("underscore");d.prototype.limit=function(a){return this._limit=a,this},d.prototype.skip=function(a){return this._skip=a,this},d.prototype.sort=function(a){return this._sort=a,this},d.prototype.projection=function(a){return this._projection=a,this},d.prototype.project=function(a){var b,c,d,e=[],g=this;return void 0===this._projection||0===Object.keys(this._projection).length?a:(b=0===this._projection._id?!1:!0,this._projection=f.omit(this._projection,"_id"),d=Object.keys(this._projection),d.forEach(function(a){if(void 0!==c&&g._projection[a]!==c)throw new Error("Can't both keep and omit fields except for _id");c=g._projection[a]}),a.forEach(function(a){var g=1===c?f.pick(a,d):f.omit(a,d);b?g._id=a._id:delete g._id,e.push(g)}),e)},d.prototype._exec=function(a){var b,c,d,f=this.db.getCandidates(this.query),g=[],h=0,i=0,j=this,k=null;try{for(b=0;b<f.length;b+=1)if(e.match(f[b],this.query))if(this._sort)g.push(f[b]);else if(this._skip&&this._skip>i)i+=1;else if(g.push(f[b]),h+=1,this._limit&&this._limit<=h)break}catch(l){return a(l)}if(this._sort){c=Object.keys(this._sort);var m=[];for(b=0;b<c.length;b++)d=c[b],m.push({key:d,direction:j._sort[d]});g.sort(function(a,b){var c,d,f;for(f=0;f<m.length;f++)if(c=m[f],d=c.direction*e.compareThings(e.getDotValue(a,c.key),e.getDotValue(b,c.key)),0!==d)return d;return 0});var n=this._limit||g.length,o=this._skip||0;g=g.slice(o,o+n)}try{g=this.project(g)}catch(p){k=p,g=void 0}return this.execFn?this.execFn(k,g,a):a(k,g)},d.prototype.exec=function(){this.db.executor.push({"this":this,fn:this._exec,arguments:arguments})},b.exports=d},{"./model":16,underscore:19}],13:[function(a,b,c){function d(a){var b;"string"==typeof a?(b=a,this.inMemoryOnly=!1):(a=a||{},b=a.filename,this.inMemoryOnly=a.inMemoryOnly||!1,this.autoload=a.autoload||!1,this.timestampData=a.timestampData||!1),b&&"string"==typeof b&&0!==b.length?this.filename=b:(this.filename=null,this.inMemoryOnly=!0),this.persistence=new l({db:this,nodeWebkitAppName:a.nodeWebkitAppName,afterSerialization:a.afterSerialization,beforeDeserialization:a.beforeDeserialization,corruptAlertThreshold:a.corruptAlertThreshold}),this.executor=new h,this.inMemoryOnly&&(this.executor.ready=!0),this.indexes={},this.indexes._id=new i({fieldName:"_id",unique:!0}),this.autoload&&this.loadDatabase(a.onload||function(a){if(a)throw a})}var e=a("./customUtils"),f=a("./model"),g=a("async"),h=a("./executor"),i=a("./indexes"),j=a("util"),k=a("underscore"),l=a("./persistence"),m=a("./cursor");d.prototype.loadDatabase=function(){this.executor.push({"this":this.persistence,fn:this.persistence.loadDatabase,arguments:arguments},!0)},d.prototype.getAllData=function(){return this.indexes._id.getAll()},d.prototype.resetIndexes=function(a){var b=this;Object.keys(this.indexes).forEach(function(c){b.indexes[c].reset(a)})},d.prototype.ensureIndex=function(a,b){var c,d=b||function(){};if(a=a||{},!a.fieldName)return c=new Error("Cannot create an index without a fieldName"),c.missingFieldName=!0,d(c);if(this.indexes[a.fieldName])return d(null);this.indexes[a.fieldName]=new i(a);try{this.indexes[a.fieldName].insert(this.getAllData())}catch(e){return delete this.indexes[a.fieldName],d(e)}this.persistence.persistNewState([{$$indexCreated:a}],function(a){return d(a?a:null)})},d.prototype.removeIndex=function(a,b){var c=b||function(){};delete this.indexes[a],this.persistence.persistNewState([{$$indexRemoved:a}],function(a){return c(a?a:null)})},d.prototype.addToIndexes=function(a){var b,c,d,e=Object.keys(this.indexes);for(b=0;b<e.length;b+=1)try{this.indexes[e[b]].insert(a)}catch(f){c=b,d=f;break}if(d){
for(b=0;c>b;b+=1)this.indexes[e[b]].remove(a);throw d}},d.prototype.removeFromIndexes=function(a){var b=this;Object.keys(this.indexes).forEach(function(c){b.indexes[c].remove(a)})},d.prototype.updateIndexes=function(a,b){var c,d,e,f=Object.keys(this.indexes);for(c=0;c<f.length;c+=1)try{this.indexes[f[c]].update(a,b)}catch(g){d=c,e=g;break}if(e){for(c=0;d>c;c+=1)this.indexes[f[c]].revertUpdate(a,b);throw e}},d.prototype.getCandidates=function(a){var b,c=Object.keys(this.indexes);return b=[],Object.keys(a).forEach(function(c){("string"==typeof a[c]||"number"==typeof a[c]||"boolean"==typeof a[c]||j.isDate(a[c])||null===a[c])&&b.push(c)}),b=k.intersection(b,c),b.length>0?this.indexes[b[0]].getMatching(a[b[0]]):(b=[],Object.keys(a).forEach(function(c){a[c]&&a[c].hasOwnProperty("$in")&&b.push(c)}),b=k.intersection(b,c),b.length>0?this.indexes[b[0]].getMatching(a[b[0]].$in):(b=[],Object.keys(a).forEach(function(c){a[c]&&(a[c].hasOwnProperty("$lt")||a[c].hasOwnProperty("$lte")||a[c].hasOwnProperty("$gt")||a[c].hasOwnProperty("$gte"))&&b.push(c)}),b=k.intersection(b,c),b.length>0?this.indexes[b[0]].getBetweenBounds(a[b[0]]):this.getAllData()))},d.prototype._insert=function(a,b){var c,d=b||function(){};try{c=this.prepareDocumentForInsertion(a),this._insertInCache(c)}catch(e){return d(e)}this.persistence.persistNewState(j.isArray(c)?c:[c],function(a){return a?d(a):d(null,f.deepCopy(c))})},d.prototype.createNewId=function(){var a=e.uid(16);return this.indexes._id.getMatching(a).length>0&&(a=this.createNewId()),a},d.prototype.prepareDocumentForInsertion=function(a){var b,c=this;if(j.isArray(a))b=[],a.forEach(function(a){b.push(c.prepareDocumentForInsertion(a))});else{b=f.deepCopy(a),void 0===b._id&&(b._id=this.createNewId());var d=new Date;this.timestampData&&void 0===b.createdAt&&(b.createdAt=d),this.timestampData&&void 0===b.updatedAt&&(b.updatedAt=d),f.checkObject(b)}return b},d.prototype._insertInCache=function(a){j.isArray(a)?this._insertMultipleDocsInCache(a):this.addToIndexes(a)},d.prototype._insertMultipleDocsInCache=function(a){var b,c,d;for(b=0;b<a.length;b+=1)try{this.addToIndexes(a[b])}catch(e){d=e,c=b;break}if(d){for(b=0;c>b;b+=1)this.removeFromIndexes(a[b]);throw d}},d.prototype.insert=function(){this.executor.push({"this":this,fn:this._insert,arguments:arguments})},d.prototype.count=function(a,b){var c=new m(this,a,function(a,b,c){return a?c(a):c(null,b.length)});return"function"!=typeof b?c:void c.exec(b)},d.prototype.find=function(a,b,c){switch(arguments.length){case 1:b={};break;case 2:"function"==typeof b&&(c=b,b={})}var d=new m(this,a,function(a,b,c){var d,e=[];if(a)return c(a);for(d=0;d<b.length;d+=1)e.push(f.deepCopy(b[d]));return c(null,e)});return d.projection(b),"function"!=typeof c?d:void d.exec(c)},d.prototype.findOne=function(a,b,c){switch(arguments.length){case 1:b={};break;case 2:"function"==typeof b&&(c=b,b={})}var d=new m(this,a,function(a,b,c){return a?c(a):1===b.length?c(null,f.deepCopy(b[0])):c(null,null)});return d.projection(b).limit(1),"function"!=typeof c?d:void d.exec(c)},d.prototype._update=function(a,b,c,d){var e,h,i,j,l=this,n=0;"function"==typeof c&&(d=c,c={}),e=d||function(){},h=void 0!==c.multi?c.multi:!1,i=void 0!==c.upsert?c.upsert:!1,g.waterfall([function(c){if(!i)return c();var d=new m(l,a);d.limit(1)._exec(function(d,g){if(d)return e(d);if(1===g.length)return c();var h;try{f.checkObject(b),h=b}catch(i){try{h=f.modify(f.deepCopy(a,!0),b)}catch(d){return e(d)}}return l._insert(h,function(a,b){return a?e(a):e(null,1,b)})})},function(){var d,g=l.getCandidates(a),i=[];try{for(j=0;j<g.length;j+=1)f.match(g[j],a)&&(h||0===n)&&(n+=1,d=f.modify(g[j],b),l.timestampData&&(d.updatedAt=new Date),i.push({oldDoc:g[j],newDoc:d}))}catch(m){return e(m)}try{l.updateIndexes(i)}catch(m){return e(m)}var o=k.pluck(i,"newDoc");l.persistence.persistNewState(o,function(a){if(a)return e(a);if(c.returnUpdatedDocs){var b=[];return o.forEach(function(a){b.push(f.deepCopy(a))}),e(null,n,b)}return e(null,n)})}])},d.prototype.update=function(){this.executor.push({"this":this,fn:this._update,arguments:arguments})},d.prototype._remove=function(a,b,c){var d,e,g=this,h=0,i=[],j=this.getCandidates(a);"function"==typeof b&&(c=b,b={}),d=c||function(){},e=void 0!==b.multi?b.multi:!1;try{j.forEach(function(b){f.match(b,a)&&(e||0===h)&&(h+=1,i.push({$$deleted:!0,_id:b._id}),g.removeFromIndexes(b))})}catch(k){return d(k)}g.persistence.persistNewState(i,function(a){return a?d(a):d(null,h)})},d.prototype.remove=function(){this.executor.push({"this":this,fn:this._remove,arguments:arguments})},b.exports=d},{"./cursor":12,"./customUtils":9,"./executor":14,"./indexes":15,"./model":16,"./persistence":17,async:18,underscore:19,util:23}],14:[function(a,b,c){(function(c){function d(){this.buffer=[],this.ready=!1,this.queue=e.queue(function(a,b){var d,e,f=a.arguments[a.arguments.length-1],g=[];for(e=0;e<a.arguments.length;e+=1)g.push(a.arguments[e]);"function"==typeof f?(d=function(){"function"==typeof setImmediate?setImmediate(b):c.nextTick(b),f.apply(null,arguments)},g[g.length-1]=d):(d=function(){b()},g.push(d)),a.fn.apply(a["this"],g)},1)}var e=a("async");d.prototype.push=function(a,b){this.ready||b?this.queue.push(a):this.buffer.push(a)},d.prototype.processBuffer=function(){var a;for(this.ready=!0,a=0;a<this.buffer.length;a+=1)this.queue.push(this.buffer[a]);this.buffer=[]},b.exports=d}).call(this,a("_process"))},{_process:21,async:18}],15:[function(a,b,c){function d(a,b){return a===b}function e(a){return null===a?"$null":"string"==typeof a?"$string"+a:"boolean"==typeof a?"$boolean"+a:"number"==typeof a?"$number"+a:j.isArray(a)?"$date"+a.getTime():a}function f(a){this.fieldName=a.fieldName,this.unique=a.unique||!1,this.sparse=a.sparse||!1,this.treeOptions={unique:this.unique,compareKeys:h.compareThings,checkValueEquality:d},this.reset()}var g=a("binary-search-tree").AVLTree,h=a("./model"),i=a("underscore"),j=a("util");f.prototype.reset=function(a){this.tree=new g(this.treeOptions),a&&this.insert(a)},f.prototype.insert=function(a){var b,c,d,f,g;if(j.isArray(a))return void this.insertMultipleDocs(a);if(b=h.getDotValue(a,this.fieldName),void 0!==b||!this.sparse)if(j.isArray(b)){for(c=i.uniq(b,e),d=0;d<c.length;d+=1)try{this.tree.insert(c[d],a)}catch(k){g=k,f=d;break}if(g){for(d=0;f>d;d+=1)this.tree["delete"](c[d],a);throw g}}else this.tree.insert(b,a)},f.prototype.insertMultipleDocs=function(a){var b,c,d;for(b=0;b<a.length;b+=1)try{this.insert(a[b])}catch(e){c=e,d=b;break}if(c){for(b=0;d>b;b+=1)this.remove(a[b]);throw c}},f.prototype.remove=function(a){var b,c=this;return j.isArray(a)?void a.forEach(function(a){c.remove(a)}):(b=h.getDotValue(a,this.fieldName),void(void 0===b&&this.sparse||(j.isArray(b)?i.uniq(b,e).forEach(function(b){c.tree["delete"](b,a)}):this.tree["delete"](b,a))))},f.prototype.update=function(a,b){if(j.isArray(a))return void this.updateMultipleDocs(a);this.remove(a);try{this.insert(b)}catch(c){throw this.insert(a),c}},f.prototype.updateMultipleDocs=function(a){var b,c,d;for(b=0;b<a.length;b+=1)this.remove(a[b].oldDoc);for(b=0;b<a.length;b+=1)try{this.insert(a[b].newDoc)}catch(e){d=e,c=b;break}if(d){for(b=0;c>b;b+=1)this.remove(a[b].newDoc);for(b=0;b<a.length;b+=1)this.insert(a[b].oldDoc);throw d}},f.prototype.revertUpdate=function(a,b){var c=[];j.isArray(a)?(a.forEach(function(a){c.push({oldDoc:a.newDoc,newDoc:a.oldDoc})}),this.update(c)):this.update(b,a)},f.prototype.getMatching=function(a){var b=this;if(j.isArray(a)){var c={},d=[];return a.forEach(function(a){b.getMatching(a).forEach(function(a){c[a._id]=a})}),Object.keys(c).forEach(function(a){d.push(c[a])}),d}return b.tree.search(a)},f.prototype.getBetweenBounds=function(a){return this.tree.betweenBounds(a)},f.prototype.getAll=function(){var a=[];return this.tree.executeOnEveryNode(function(b){var c;for(c=0;c<b.data.length;c+=1)a.push(b.data[c])}),a},b.exports=f},{"./model":16,"binary-search-tree":2,underscore:19,util:23}],16:[function(a,b,c){function d(a,b){if("number"==typeof a&&(a=a.toString()),!("$"!==a[0]||"$$date"===a&&"number"==typeof b||"$$deleted"===a&&b===!0||"$$indexCreated"===a||"$$indexRemoved"===a))throw new Error("Field names cannot begin with the $ character");if(-1!==a.indexOf("."))throw new Error("Field names cannot contain a .")}function e(a){t.isArray(a)&&a.forEach(function(a){e(a)}),"object"==typeof a&&null!==a&&Object.keys(a).forEach(function(b){d(b,a[b]),e(a[b])})}function f(a){var b;return b=JSON.stringify(a,function(a,b){return d(a,b),void 0!==b?null===b?null:"function"==typeof this[a].getTime?{$$date:this[a].getTime()}:b:void 0})}function g(a){return JSON.parse(a,function(a,b){return"$$date"===a?new Date(b):"string"==typeof b||"number"==typeof b||"boolean"==typeof b||null===b?b:b&&b.$$date?b.$$date:b})}function h(a,b){var c;return"boolean"==typeof a||"number"==typeof a||"string"==typeof a||null===a||t.isDate(a)?a:t.isArray(a)?(c=[],a.forEach(function(a){c.push(h(a,b))}),c):"object"==typeof a?(c={},Object.keys(a).forEach(function(d){(!b||"$"!==d[0]&&-1===d.indexOf("."))&&(c[d]=h(a[d],b))}),c):void 0}function i(a){return"boolean"==typeof a||"number"==typeof a||"string"==typeof a||null===a||t.isDate(a)||t.isArray(a)}function j(a,b){return b>a?-1:a>b?1:0}function k(a,b){var c,d;for(c=0;c<Math.min(a.length,b.length);c+=1)if(d=l(a[c],b[c]),0!==d)return d;return j(a.length,b.length)}function l(a,b){var c,d,e,f;if(void 0===a)return void 0===b?0:-1;if(void 0===b)return void 0===a?0:1;if(null===a)return null===b?0:-1;if(null===b)return null===a?0:1;if("number"==typeof a)return"number"==typeof b?j(a,b):-1;if("number"==typeof b)return"number"==typeof a?j(a,b):1;if("string"==typeof a)return"string"==typeof b?j(a,b):-1;if("string"==typeof b)return"string"==typeof a?j(a,b):1;if("boolean"==typeof a)return"boolean"==typeof b?j(a,b):-1;if("boolean"==typeof b)return"boolean"==typeof a?j(a,b):1;if(t.isDate(a))return t.isDate(b)?j(a.getTime(),b.getTime()):-1;if(t.isDate(b))return t.isDate(a)?j(a.getTime(),b.getTime()):1;if(t.isArray(a))return t.isArray(b)?k(a,b):-1;if(t.isArray(b))return t.isArray(a)?k(a,b):1;for(c=Object.keys(a).sort(),d=Object.keys(b).sort(),f=0;f<Math.min(c.length,d.length);f+=1)if(e=l(a[c[f]],b[d[f]]),0!==e)return e;return j(c.length,d.length)}function m(a){return function(b,c,d){var e="string"==typeof c?c.split("."):c;1===e.length?w[a](b,c,d):(b[e[0]]=b[e[0]]||{},v[a](b[e[0]],e.slice(1),d))}}function n(a,b){var c,d,f=Object.keys(b),g=u.map(f,function(a){return a[0]}),i=u.filter(g,function(a){return"$"===a});if(-1!==f.indexOf("_id")&&b._id!==a._id)throw new Error("You cannot change a document's _id");if(0!==i.length&&i.length!==g.length)throw new Error("You cannot mix modifiers and normal fields");if(0===i.length?(c=h(b),c._id=a._id):(d=u.uniq(f),c=h(a),d.forEach(function(a){var d;if(!v[a])throw new Error("Unknown modifier "+a);if("object"!=typeof b[a])throw new Error("Modifier "+a+"'s argument must be an object");d=Object.keys(b[a]),d.forEach(function(d){v[a](c,d,b[a][d])})})),e(c),a._id!==c._id)throw new Error("You can't change a document's _id");return c}function o(a,b){var c,d,e="string"==typeof b?b.split("."):b;if(a){if(0===e.length)return a;if(1===e.length)return a[e[0]];if(t.isArray(a[e[0]])){if(c=parseInt(e[1],10),"number"==typeof c&&!isNaN(c))return o(a[e[0]][c],e.slice(2));for(d=new Array,c=0;c<a[e[0]].length;c+=1)d.push(o(a[e[0]][c],e.slice(1)));return d}return o(a[e[0]],e.slice(1))}}function p(a,b){var c,d,e;if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||null===b||"string"==typeof b||"boolean"==typeof b||"number"==typeof b)return a===b;if(t.isDate(a)||t.isDate(b))return t.isDate(a)&&t.isDate(b)&&a.getTime()===b.getTime();if(t.isArray(a)||t.isArray(b)||void 0===a||void 0===b)return!1;try{c=Object.keys(a),d=Object.keys(b)}catch(f){return!1}if(c.length!==d.length)return!1;for(e=0;e<c.length;e+=1){if(-1===d.indexOf(c[e]))return!1;if(!p(a[c[e]],b[c[e]]))return!1}return!0}function q(a,b){return"string"==typeof a||"number"==typeof a||t.isDate(a)||"string"==typeof b||"number"==typeof b||t.isDate(b)?typeof a!=typeof b?!1:!0:!1}function r(a,b){var c,d,e,f;if(i(a)||i(b))return s({needAKey:a},"needAKey",b);for(c=Object.keys(b),f=0;f<c.length;f+=1)if(d=c[f],e=b[d],"$"===d[0]){if(!y[d])throw new Error("Unknown logical operator "+d);if(!y[d](a,e))return!1}else if(!s(a,d,e))return!1;return!0}function s(a,b,c,d){var e,f,g,h,i=o(a,b);if(t.isArray(i)&&!d){if(null!==c&&"object"==typeof c&&!t.isRegExp(c))for(f=Object.keys(c),e=0;e<f.length;e+=1)if(z[f[e]])return s(a,b,c,!0);for(e=0;e<i.length;e+=1)if(s({k:i[e]},"k",c))return!0;return!1}if(null!==c&&"object"==typeof c&&!t.isRegExp(c)){if(f=Object.keys(c),g=u.map(f,function(a){return a[0]}),h=u.filter(g,function(a){return"$"===a}),0!==h.length&&h.length!==g.length)throw new Error("You cannot mix operators and normal fields");if(h.length>0){for(e=0;e<f.length;e+=1){if(!x[f[e]])throw new Error("Unknown comparison function "+f[e]);if(!x[f[e]](i,c[f[e]]))return!1}return!0}}return t.isRegExp(c)?x.$regex(i,c):p(i,c)?!0:!1}var t=a("util"),u=a("underscore"),v={},w={},x={},y={},z={};w.$set=function(a,b,c){a[b]=c},w.$unset=function(a,b,c){delete a[b]},w.$push=function(a,b,c){if(a.hasOwnProperty(b)||(a[b]=[]),!t.isArray(a[b]))throw new Error("Can't $push an element on non-array values");if(null!==c&&"object"==typeof c&&c.$each){if(Object.keys(c).length>1)throw new Error("Can't use another field in conjunction with $each");if(!t.isArray(c.$each))throw new Error("$each requires an array value");c.$each.forEach(function(c){a[b].push(c)})}else a[b].push(c)},w.$addToSet=function(a,b,c){var d=!0;if(a.hasOwnProperty(b)||(a[b]=[]),!t.isArray(a[b]))throw new Error("Can't $addToSet an element on non-array values");if(null!==c&&"object"==typeof c&&c.$each){if(Object.keys(c).length>1)throw new Error("Can't use another field in conjunction with $each");if(!t.isArray(c.$each))throw new Error("$each requires an array value");c.$each.forEach(function(c){w.$addToSet(a,b,c)})}else a[b].forEach(function(a){0===l(a,c)&&(d=!1)}),d&&a[b].push(c)},w.$pop=function(a,b,c){if(!t.isArray(a[b]))throw new Error("Can't $pop an element from non-array values");if("number"!=typeof c)throw new Error(c+" isn't an integer, can't use it with $pop");0!==c&&(c>0?a[b]=a[b].slice(0,a[b].length-1):a[b]=a[b].slice(1))},w.$pull=function(a,b,c){var d,e;if(!t.isArray(a[b]))throw new Error("Can't $pull an element from non-array values");for(d=a[b],e=d.length-1;e>=0;e-=1)r(d[e],c)&&d.splice(e,1)},w.$inc=function(a,b,c){if("number"!=typeof c)throw new Error(c+" must be a number");if("number"!=typeof a[b]){if(u.has(a,b))throw new Error("Don't use the $inc modifier on non-number fields");a[b]=c}else a[b]+=c},Object.keys(w).forEach(function(a){v[a]=m(a)}),x.$lt=function(a,b){return q(a,b)&&b>a},x.$lte=function(a,b){return q(a,b)&&b>=a},x.$gt=function(a,b){return q(a,b)&&a>b},x.$gte=function(a,b){return q(a,b)&&a>=b},x.$ne=function(a,b){return void 0===a?!0:!p(a,b)},x.$in=function(a,b){var c;if(!t.isArray(b))throw new Error("$in operator called with a non-array");for(c=0;c<b.length;c+=1)if(p(a,b[c]))return!0;return!1},x.$nin=function(a,b){if(!t.isArray(b))throw new Error("$nin operator called with a non-array");return!x.$in(a,b)},x.$regex=function(a,b){if(!t.isRegExp(b))throw new Error("$regex operator called with non regular expression");return"string"!=typeof a?!1:b.test(a)},x.$exists=function(a,b){return b=b||""===b?!0:!1,void 0===a?!b:b},x.$size=function(a,b){if(!t.isArray(a))return!1;if(b%1!==0)throw new Error("$size operator called without an integer");return a.length==b},z.$size=!0,y.$or=function(a,b){var c;if(!t.isArray(b))throw new Error("$or operator used without an array");for(c=0;c<b.length;c+=1)if(r(a,b[c]))return!0;return!1},y.$and=function(a,b){var c;if(!t.isArray(b))throw new Error("$and operator used without an array");for(c=0;c<b.length;c+=1)if(!r(a,b[c]))return!1;return!0},y.$not=function(a,b){return!r(a,b)},y.$where=function(a,b){var c;if(!u.isFunction(b))throw new Error("$where operator used without a function");if(c=b.call(a),!u.isBoolean(c))throw new Error("$where function must return boolean");return c},b.exports.serialize=f,b.exports.deserialize=g,b.exports.deepCopy=h,b.exports.checkObject=e,b.exports.isPrimitiveType=i,b.exports.modify=n,b.exports.getDotValue=o,b.exports.match=r,b.exports.areThingsEqual=p,b.exports.compareThings=l},{underscore:19,util:23}],17:[function(a,b,c){(function(c){function d(a){var b,c,e;if(this.db=a.db,this.inMemoryOnly=this.db.inMemoryOnly,this.filename=this.db.filename,this.corruptAlertThreshold=void 0!==a.corruptAlertThreshold?a.corruptAlertThreshold:.1,!this.inMemoryOnly&&this.filename&&"~"===this.filename.charAt(this.filename.length-1))throw new Error("The datafile name can't end with a ~, which is reserved for crash safe backup files");if(a.afterSerialization&&!a.beforeDeserialization)throw new Error("Serialization hook defined but deserialization hook undefined, cautiously refusing to start NeDB to prevent dataloss");if(!a.afterSerialization&&a.beforeDeserialization)throw new Error("Serialization hook undefined but deserialization hook defined, cautiously refusing to start NeDB to prevent dataloss");for(this.afterSerialization=a.afterSerialization||function(a){return a},this.beforeDeserialization=a.beforeDeserialization||function(a){return a},b=1;30>b;b+=1)for(c=0;10>c;c+=1)if(e=i.uid(b),this.beforeDeserialization(this.afterSerialization(e))!==e)throw new Error("beforeDeserialization is not the reverse of afterSerialization, cautiously refusing to start NeDB to prevent dataloss");this.filename&&a.nodeWebkitAppName&&(console.log("=================================================================="),console.log("WARNING: The nodeWebkitAppName option is deprecated"),console.log("To get the path to the directory where Node Webkit stores the data"),console.log("for your app, use the internal nw.gui module like this"),console.log("require('nw.gui').App.dataPath"),console.log("See https://github.com/rogerwang/node-webkit/issues/500"),console.log("=================================================================="),this.filename=d.getNWAppFilename(a.nodeWebkitAppName,this.filename))}var e=a("./storage"),f=a("path"),g=a("./model"),h=a("async"),i=a("./customUtils"),j=a("./indexes");d.ensureDirectoryExists=function(a,b){var c=b||function(){};e.mkdirp(a,function(a){return c(a)})},d.getNWAppFilename=function(a,b){var d;switch(c.platform){case"win32":case"win64":if(d=c.env.LOCALAPPDATA||c.env.APPDATA,!d)throw new Error("Couldn't find the base application data folder");d=f.join(d,a);break;case"darwin":if(d=c.env.HOME,!d)throw new Error("Couldn't find the base application data directory");d=f.join(d,"Library","Application Support",a);break;case"linux":if(d=c.env.HOME,!d)throw new Error("Couldn't find the base application data directory");d=f.join(d,".config",a);break;default:throw new Error("Can't use the Node Webkit relative path for platform "+c.platform)}return f.join(d,"nedb-data",b)},d.prototype.persistCachedDatabase=function(a){var b=a||function(){},c="",d=this;return this.inMemoryOnly?b(null):(this.db.getAllData().forEach(function(a){c+=d.afterSerialization(g.serialize(a))+"\n"}),Object.keys(this.db.indexes).forEach(function(a){"_id"!=a&&(c+=d.afterSerialization(g.serialize({$$indexCreated:{fieldName:a,unique:d.db.indexes[a].unique,sparse:d.db.indexes[a].sparse}}))+"\n")}),void e.crashSafeWriteFile(this.filename,c,b))},d.prototype.compactDatafile=function(){this.db.executor.push({"this":this,fn:this.persistCachedDatabase,arguments:[]})},d.prototype.setAutocompactionInterval=function(a){var b=this,c=5e3,d=Math.max(a||0,c);this.stopAutocompaction(),this.autocompactionIntervalId=setInterval(function(){b.compactDatafile()},d)},d.prototype.stopAutocompaction=function(){this.autocompactionIntervalId&&clearInterval(this.autocompactionIntervalId)},d.prototype.persistNewState=function(a,b){var c=this,d="",f=b||function(){};return c.inMemoryOnly?f(null):(a.forEach(function(a){d+=c.afterSerialization(g.serialize(a))+"\n"}),0===d.length?f(null):void e.appendFile(c.filename,d,"utf8",function(a){return f(a)}))},d.prototype.treatRawData=function(a){var b,c=a.split("\n"),d={},e=[],f={},h=-1;for(b=0;b<c.length;b+=1){var i;try{i=g.deserialize(this.beforeDeserialization(c[b])),i._id?i.$$deleted===!0?delete d[i._id]:d[i._id]=i:i.$$indexCreated&&void 0!=i.$$indexCreated.fieldName?f[i.$$indexCreated.fieldName]=i.$$indexCreated:"string"==typeof i.$$indexRemoved&&delete f[i.$$indexRemoved]}catch(j){h+=1}}if(c.length>0&&h/c.length>this.corruptAlertThreshold)throw new Error("More than "+Math.floor(100*this.corruptAlertThreshold)+"% of the data file is corrupt, the wrong beforeDeserialization hook may be used. Cautiously refusing to start NeDB to prevent dataloss");return Object.keys(d).forEach(function(a){e.push(d[a])}),{data:e,indexes:f}},d.prototype.loadDatabase=function(a){var b=a||function(){},c=this;return c.db.resetIndexes(),c.inMemoryOnly?b(null):void h.waterfall([function(a){d.ensureDirectoryExists(f.dirname(c.filename),function(b){e.ensureDatafileIntegrity(c.filename,function(b){e.readFile(c.filename,"utf8",function(b,d){if(b)return a(b);try{var e=c.treatRawData(d)}catch(f){return a(f)}Object.keys(e.indexes).forEach(function(a){c.db.indexes[a]=new j(e.indexes[a])});try{c.db.resetIndexes(e.data)}catch(f){return c.db.resetIndexes(),a(f)}c.db.persistence.persistCachedDatabase(a)})})})}],function(a){return a?b(a):(c.db.executor.processBuffer(),b(null))})},b.exports=d}).call(this,a("_process"))},{"./customUtils":9,"./indexes":15,"./model":16,"./storage":10,_process:21,async:18,path:20}],18:[function(b,c,d){(function(b){!function(){function d(a){var b=!1;return function(){if(b)throw new Error("Callback was already called.");b=!0,a.apply(e,arguments)}}var e,f,g={};e=this,null!=e&&(f=e.async),g.noConflict=function(){return e.async=f,g};var h=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},i=function(a,b){if(a.map)return a.map(b);var c=[];return h(a,function(a,d,e){c.push(b(a,d,e))}),c},j=function(a,b,c){return a.reduce?a.reduce(b,c):(h(a,function(a,d,e){c=b(c,a,d,e)}),c)},k=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};"undefined"!=typeof b&&b.nextTick?(g.nextTick=b.nextTick,"undefined"!=typeof setImmediate?g.setImmediate=function(a){setImmediate(a)}:g.setImmediate=g.nextTick):"function"==typeof setImmediate?(g.nextTick=function(a){setImmediate(a)},g.setImmediate=g.nextTick):(g.nextTick=function(a){setTimeout(a,0)},g.setImmediate=g.nextTick),g.each=function(a,b,c){if(c=c||function(){},!a.length)return c();var e=0;h(a,function(f){b(f,d(function(b){b?(c(b),c=function(){}):(e+=1,e>=a.length&&c(null))}))})},g.forEach=g.each,g.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c(null):e())})};e()},g.forEachSeries=g.eachSeries,g.eachLimit=function(a,b,c,d){var e=l(b);e.apply(null,[a,c,d])},g.forEachLimit=g.eachLimit;var l=function(a){return function(b,c,d){if(d=d||function(){},!b.length||0>=a)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;a>g&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},m=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[g.each].concat(b))}},n=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[l(a)].concat(c))}},o=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[g.eachSeries].concat(b))}},p=function(a,b,c,d){var e=[];b=i(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})};g.map=m(p),g.mapSeries=o(p),g.mapLimit=function(a,b,c,d){return q(b)(a,c,d)};var q=function(a){return n(a,p)};g.reduce=function(a,b,c,d){g.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){d(a,b)})},g.inject=g.reduce,g.foldl=g.reduce,g.reduceRight=function(a,b,c,d){var e=i(a,function(a){return a}).reverse();g.reduce(e,b,c,d)},g.foldr=g.reduceRight;var r=function(a,b,c,d){var e=[];b=i(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(a){d(i(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};g.filter=m(r),g.filterSeries=o(r),g.select=g.filter,g.selectSeries=g.filterSeries;var s=function(a,b,c,d){var e=[];b=i(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(a){d(i(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};g.reject=m(s),g.rejectSeries=o(s);var t=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(a){d()})};g.detect=m(t),g.detectSeries=o(t),g.some=function(a,b,c){g.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(a){c(!1)})},g.any=g.some,g.every=function(a,b,c){g.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(a){c(!0)})},g.all=g.every,g.sortBy=function(a,b,c){g.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return d>c?-1:c>d?1:0};c(null,i(b.sort(d),function(a){return a.value}))})},g.auto=function(a,b){b=b||function(){};var c=k(a);if(!c.length)return b(null);var d={},e=[],f=function(a){e.unshift(a)},i=function(a){for(var b=0;b<e.length;b+=1)if(e[b]===a)return void e.splice(b,1)},l=function(){h(e.slice(0),function(a){a()})};f(function(){k(d).length===c.length&&(b(null,d),b=function(){})}),h(c,function(c){var e=a[c]instanceof Function?[a[c]]:a[c],m=function(a){var e=Array.prototype.slice.call(arguments,1);if(e.length<=1&&(e=e[0]),a){var f={};h(k(d),function(a){f[a]=d[a]}),f[c]=e,b(a,f),b=function(){}}else d[c]=e,g.setImmediate(l)},n=e.slice(0,Math.abs(e.length-1))||[],o=function(){return j(n,function(a,b){return a&&d.hasOwnProperty(b)},!0)&&!d.hasOwnProperty(c)};if(o())e[e.length-1](m,d);else{var p=function(){o()&&(i(p),e[e.length-1](m,d))};f(p)}})},g.waterfall=function(a,b){if(b=b||function(){},a.constructor!==Array){var c=new Error("First argument to waterfall must be an array of functions");return b(c)}if(!a.length)return b();var d=function(a){return function(c){if(c)b.apply(null,arguments),b=function(){};else{var e=Array.prototype.slice.call(arguments,1),f=a.next();f?e.push(d(f)):e.push(b),g.setImmediate(function(){a.apply(null,e)})}}};d(g.iterator(a))()};var u=function(a,b,c){if(c=c||function(){},b.constructor===Array)a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(k(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};g.parallel=function(a,b){u({map:g.map,each:g.each},a,b)},g.parallelLimit=function(a,b,c){u({map:q(b),each:l(b)},a,c)},g.series=function(a,b){if(b=b||function(){},a.constructor===Array)g.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};g.eachSeries(k(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},g.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},g.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var v=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};g.concat=m(v),g.concatSeries=o(v),g.whilst=function(a,b,c){a()?b(function(d){return d?c(d):void g.whilst(a,b,c)}):c()},g.doWhilst=function(a,b,c){a(function(d){return d?c(d):void(b()?g.doWhilst(a,b,c):c())})},g.until=function(a,b,c){a()?c():b(function(d){return d?c(d):void g.until(a,b,c)})},g.doUntil=function(a,b,c){a(function(d){return d?c(d):void(b()?c():g.doUntil(a,b,c))})},g.queue=function(a,b){function c(a,c,d,e){c.constructor!==Array&&(c=[c]),h(c,function(c){var f={data:c,callback:"function"==typeof e?e:null};d?a.tasks.unshift(f):a.tasks.push(f),a.saturated&&a.tasks.length===b&&a.saturated(),g.setImmediate(a.process)})}void 0===b&&(b=1);var e=0,f={tasks:[],concurrency:b,saturated:null,empty:null,drain:null,push:function(a,b){c(f,a,!1,b)},unshift:function(a,b){c(f,a,!0,b)},process:function(){if(e<f.concurrency&&f.tasks.length){var b=f.tasks.shift();f.empty&&0===f.tasks.length&&f.empty(),e+=1;var c=function(){e-=1,b.callback&&b.callback.apply(b,arguments),f.drain&&f.tasks.length+e===0&&f.drain(),f.process()},g=d(c);a(b.data,g)}},length:function(){return f.tasks.length},running:function(){return e}};return f},g.cargo=function(a,b){var c=!1,d=[],e={tasks:d,payload:b,saturated:null,empty:null,drain:null,push:function(a,c){a.constructor!==Array&&(a=[a]),h(a,function(a){d.push({data:a,callback:"function"==typeof c?c:null}),e.saturated&&d.length===b&&e.saturated()}),g.setImmediate(e.process)},process:function f(){if(!c){if(0===d.length)return void(e.drain&&e.drain());var g="number"==typeof b?d.splice(0,b):d.splice(0),j=i(g,function(a){return a.data});e.empty&&e.empty(),c=!0,a(j,function(){c=!1;var a=arguments;h(g,function(b){b.callback&&b.callback.apply(null,a)}),f()})}},length:function(){return d.length},running:function(){return c}};return e};var w=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&console.error(b):console[a]&&h(c,function(b){console[a](b)}))}]))}};g.log=w("log"),g.dir=w("dir"),g.memoize=function(a,b){var c={},d={};b=b||function(a){return a};var e=function(){var e=Array.prototype.slice.call(arguments),f=e.pop(),g=b.apply(null,e);g in c?f.apply(null,c[g]):g in d?d[g].push(f):(d[g]=[f],a.apply(null,e.concat([function(){c[g]=arguments;var a=d[g];delete d[g];for(var b=0,e=a.length;e>b;b++)a[b].apply(null,arguments)}])))};return e.memo=c,e.unmemoized=a,e},g.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},g.times=function(a,b,c){for(var d=[],e=0;a>e;e++)d.push(e);return g.map(d,b,c)},g.timesSeries=function(a,b,c){for(var d=[],e=0;a>e;e++)d.push(e);return g.mapSeries(d,b,c)},g.compose=function(){var a=Array.prototype.reverse.call(arguments);return function(){var b=this,c=Array.prototype.slice.call(arguments),d=c.pop();g.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){d.apply(b,[a].concat(c))})}};var x=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return c.apply(this,d)}return c};g.applyEach=m(x),g.applyEachSeries=o(x),g.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d}a(c)}c()},"undefined"!=typeof a&&a.amd?a([],function(){return g}):"undefined"!=typeof c&&c.exports?c.exports=g:e.async=g}()}).call(this,b("_process"))},{_process:21}],19:[function(a,b,c){arguments[4][6][0].apply(c,arguments)},{dup:6}],20:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){
return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a,b){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}}).call(this,a("_process"))},{_process:21}],21:[function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h&&h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],22:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],23:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":22,_process:21,inherits:7}],24:[function(a,b,c){b.exports={name:"nedboose",version:"0.1.0",description:"Mongoose-style ODM for NeDB",author:{name:"James M. Greene",email:"james.m.greene@gmail.com",url:"http://greene.io/"},license:"MIT",repository:{type:"git",url:"git+https://github.com/JamesMGreene/nedboose.git"},bugs:{url:"https://github.com/JamesMGreene/nedboose/issues"},homepage:"https://github.com/JamesMGreene/nedboose#readme",keywords:["nedb","mongolite","document","model","schema","database","odm","data","datastore","query","nosql","orm","db","collection"],main:"index.js",scripts:{test:"grunt travis --verbose"},config:{blanket:{pattern:"","data-cover-never":["node_modules","test","coverage"],"data-cover-reporter-options":{relativepath:!0}},"travis-cov":{threshold:100}},peerDependencies:{nedb:"^1.6.0"},devDependencies:{chai:"^3.4.1",grunt:"^0.4.5","grunt-browserify":"^4.0.1","grunt-contrib-jshint":"^0.11.3","grunt-contrib-uglify":"^0.11.0","grunt-env":"^0.4.4","grunt-mocha-cov":"^0.4.0","grunt-open":"^0.2.3",mocha:"^2.3.4",nedb:"^1.6.0","travis-cov":"^0.2.5"}}},{}],25:[function(a,b,c){function d(){}b.exports=d},{}],26:[function(a,b,c){function d(){}b.exports=d},{}],27:[function(a,b,c){function d(){}b.exports=d},{}],28:[function(a,b,c){function d(){}b.exports=d},{}],29:[function(a,b,c){function d(a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack,this.name="NedbooseError",this.message=a}var e=a("util");e.inherits(d,Error),b.exports=d},{util:23}],30:[function(a,b,c){function d(){}b.exports=d},{}],31:[function(a,b,c){function d(){}b.exports=d},{}],32:[function(a,b,c){function d(){}b.exports=d},{}],33:[function(a,b,c){function d(){}b.exports=d},{}],34:[function(a,b,c){function d(){}b.exports=d},{}],35:[function(a,b,c){function d(){}b.exports=d},{}],36:[function(a,b,c){function d(){}b.exports=d},{}],37:[function(a,b,c){function d(){}b.exports=d},{}]},{},[1])(1)});
//# sourceMappingURL=nedboose.min.map